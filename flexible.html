<!doctype html><html><head><meta charset=UTF-8><title>移动端页面适配方案 - By riskers</title><link rel=stylesheet href=//cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css><link rel=stylesheet href=//cdn.staticfile.org/prism/1.15.0/themes/prism.min.css><link rel=stylesheet href=//cdn.staticfile.org/KaTeX/0.10.0-rc.1/katex.min.css><link href=./md/img/css/chunk-vendors.676174ea.css rel=stylesheet></head><body><div><article id=webslides><section slide class=slide :class=aligncenter><div class="wrap aligncenter" wrap=true><h1>移动端页面适配方案</h1><hr><p><a href=https://github.com/riskers/blog target=_blank><i class="fa fa-home"></i></a> <a href=https://github.com/riskers/ target=_blank><i class="fa fa-github"></i></a> <a href=http://weibo.com/damaoxianjia123 target=_blank><i class="fa fa-weibo"></i></a></p></div></section><section slide class=slide :class=aligncenter><div class="wrap aligncenter" wrap=true><h1>1. 像素</h1></div></section><section slide class=slide><div class=wrap wrap=true><p><code>width:200px</code> 代表什么？<code>px</code>到底是多长？</p><ul><li><p><strong>设备像素</strong> {:&.fadeIn} 屏幕的物理像素，任何设备屏幕的物理像素的数量都是固定不变的，单位是<code>pt</code></p></li><li><p><strong>CSS 像素</strong></p><ul><li>在 CSS、JS 中使用的抽象单位，单位是<code>px</code></li><li>CSS 像素也被称为<strong>设备独立像素</strong>(dips)，单位是<code>dp</code></li></ul></li></ul></div></section><section slide class=slide><div class=wrap wrap=true><h2>设备像素与CSS像素的关系</h2><hr><ul><li>取决于两个条件<ul><li :&amp;.fadein="">页面是否缩放</li><li>屏幕是否为高密度</li></ul></li></ul></div></section><section slide class=slide><div class=wrap wrap=true><h2>分辨率、屏幕尺寸和屏幕像素密度</h2><hr><p>以 iPhone5 为例</p><ul><li :&amp;.fadein=""><p><strong>分辨率</strong>： <code>1136pt x 640pt</code></p></li><li><p><strong>屏幕尺寸</strong>： <code>4英寸</code></p></li><li><p><strong>屏幕像素密度</strong>：<code>326dpi</code></p><ul><li>屏幕像素密度（Pibel Per Inch）简称 <code>ppi</code> ，单位是 <code>dpi</code>（dot per inch）。这里指屏幕水平或垂直每英寸有 326 个物理像素。原则上来说，ppi 越高越好，因为图像会更加细腻清晰。</li></ul></li><li><p><img src=https://github-riskers-blog.oss-cn-qingdao.aliyuncs.com/20200327171918.png alt=ppi></p></li><li><p>https:://www.sven.de/dpi/</p></li></ul></div></section><section slide class=slide :class=aligncenter><div class="wrap aligncenter" wrap=true><h2>2. 视口</h2><hr><ul><li :&amp;.fadein="">桌面浏览器<ul><li :&amp;.movein="">浏览器窗口就是约束你的 CSS 布局视口（又称初始包含块），是所有 CSS 百分比宽度推算的根源</li><li>它的作用是给<strong>CSS 布局限制了一个最大宽度</strong>，视口的宽度和浏览器窗口宽度一致</li></ul></li><li>在移动端，情况就变得很复杂了</li><li>以下讨论的宽度单位都是 <strong>CSS 像素</strong> (除了<code>screen.width</code>)</li></ul></div></section><section slide class=slide><div class=wrap wrap=true><h2>布局视口</h2><hr><ul><li :&amp;.fadein="">一个没有为移动端做优化的网页，会尽可能缩小网页让用户看到所有东西</li><li>浏览器厂商为了让用户在小屏幕下网页也能够显示地很好，所以把视口宽度设置地很大，一般在 768px ~ 1024px 之间，最常见的宽度是 980px</li><li><img src=https://github-riskers-blog.oss-cn-qingdao.aliyuncs.com/20200327171851.png alt=布局视口></li></ul></div></section><section slide class=slide><div class=wrap wrap=true><h2>布局视口</h2><hr><ul><li :&amp;.fadein=""><p><strong>设置布局视口的宽度</strong></p><pre class=language-html><code class=language-html><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width=640<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
</code></pre></li><li><p>获取布局视口尺寸</p><p><code>document.documentElement.clientWidth/Height</code></p></li></ul></div></section><section slide class=slide><div class=wrap wrap=true><h2>视觉视口</h2><hr><ul><li :&amp;.fadein=""><p>用户正在看到的网页的区域，大小是屏幕中<strong>CSS 像素</strong>的数量</p></li><li><p><img src=https://github-riskers-blog.oss-cn-qingdao.aliyuncs.com/20200327172001.png alt=视觉视口></p></li><li><p>获取视觉视口尺寸</p><p><code>window.innerWidth/Height</code></p></li></ul></div></section><section slide class=slide><div class=wrap wrap=true><h2>理想视口</h2><hr><ul><li :&amp;.fadein=""><strong>对设备来说最理想的布局视口尺寸</strong><ul><li :&amp;.movein="">布局视口忽略了手机本身的尺寸</li><li>视觉视口对开发没什么用</li><li>理想视口中的页面有最理想的宽度，用户进入页面不用缩放</li></ul></li><li>使用理想视口<ul><li><code>&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width&quot;&gt;</code></li><li>其实就是把布局视口设置成屏幕宽度</li><li>定义理想视口是浏览器的事情，并不能简单地认为是开发者定义的，开发者只能使用</li></ul></li></ul></div></section><section slide class=slide :class=aligncenter><div class="wrap aligncenter" wrap=true><h1>3. screen.width/height</h1></div></section><section slide class=slide><div class=wrap wrap=true><p><code>screen.width/height</code> 返回理想视口的尺寸，有严重兼容性问题，可能返回两种值：</p><ul><li :&amp;.movein=""><p>理想视口的尺寸（下载浏览器）</p></li><li><p>屏幕的设备像素尺寸（内置浏览器）</p></li><li><p>测试 <code>screen.width</code>，同一设备的不同浏览器返回的值可能是不一样的：</p><ul><li><a href=http://quirksmode.org/m/tests/widthtest.html target=_blank>Screen size tests</a></li><li><a href=http://andreasbovens.github.io/understanding-viewport/ target=_blank>Understanding viewport</a></li></ul></li></ul></div><div class=speaker-note><div class=wrap><p>默认浏览器是安卓系统内置的浏览器，长下面那个样子。而且它使用的是Webkit而不是Blink。只有在更新安卓系统的时候才能更新它。直到安卓4.3，Google不再更新。</p><p><img src=https://github-riskers-blog.oss-cn-qingdao.aliyuncs.com/20200327171549.jpg alt=安卓webkit></p><p>而下载浏览器都返回的是理想视口尺寸。</p></div></div></section><section slide class=slide :class=aligncenter><div class="wrap aligncenter" wrap=true><h1>4. 缩放</h1></div></section><section slide class=slide><div class=wrap wrap=true><h3>缩放与设备像素、CSS像素的关系</h3><hr><ul><li :&amp;.fadein="">缩放是在放大或缩小<strong>CSS 像素</strong></li></ul><p>[note] 比如一个宽度为 200px 的元素无论放大，还是200个CSS像素。但是因为这些像素被放大了，所以CSS像素也就跨越了更多的设备像素。缩小则相反。 [/note]</p></div></section><section slide class=slide><div class=wrap wrap=true><h2>缩放与视口</h2><hr><ul><li :&amp;.fadein=""><strong>缩放会影响视觉视口的尺寸</strong><ul><li :&amp;.fadein="">因为缩放了 CSS 像素</li></ul></li><li><strong>用户缩放不会影响布局视口</strong><ul><li :&amp;.fadein="">注意，这是『用户缩放』，后面会说开发者设置缩放的情况</li></ul></li></ul></div></section><section slide class=slide><div class=wrap wrap=true><h2>查看缩放比例</h2><hr><p><img src=https://github-riskers-blog.oss-cn-qingdao.aliyuncs.com/20200327171932.png alt=查看缩放比例></p><blockquote><p>这里的 0.3 是相对于<strong>理想视口</strong>的</p></blockquote></div></section><section slide class=slide><div class=wrap wrap=true><h2>计算缩放比例</h2><hr><p>在下载浏览器中，可以这么算（理想视口与视觉视口的比）：</p><pre class=language-textile><code class=language-textile><span class="token phrase">zoom level = screen.width / window.innerWidth
</span></code></pre></div></section><section slide class=slide><div class=wrap wrap=true><h2>禁止缩放</h2><hr><pre class=language-html><code class=language-html><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>user-scalable=no<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
</code></pre></div></section><section slide class=slide><div class=wrap wrap=true><h2>设置缩放</h2><hr><pre class=language-html><code class=language-html><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>initial-scale=2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
</code></pre><p>使用<code>initial-scale</code>有一个副作用：同时也会将布局视口的尺寸设置为缩放后的尺寸。所以<code>initial-scale=1</code>与<code>width=device-width</code>的效果是一样的。</p></div></section><section slide class=slide :class=aligncenter><div class="wrap aligncenter" wrap=true><h1>5. 完美视口</h1></div></section><section slide class=slide><div class=wrap wrap=true><p>解决各种浏览器兼容问题的理想视口设置</p><pre class=language-html><code class=language-html><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width=device-width,initial-scale=1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
</code></pre></div></section><section slide class=slide :class=aligncenter><div class="wrap aligncenter" wrap=true><h1>6. 设备像素比</h1></div></section><section slide class=slide><div class=wrap wrap=true><h2>DPR</h2><hr><ul><li :&amp;.movein=""><code>window.devicePixelRatio</code></li><li>与设备像素、CSS 像素的关系<ul><li :&amp;.fadein=""><code>dpr = 设备像素 / CSS像素</code></li></ul></li><li>与视口的关系<ul><li :&amp;.fadein=""><code>dpr = 屏幕横向设备像素 / 理想视口的宽</code></li></ul></li></ul></div></section><section slide class=slide :class=aligncenter><div class="wrap aligncenter" wrap=true><h1>7. 适配方案</h1></div></section><section slide class=slide><div class=wrap wrap=true><h2>什么是适配</h2><hr><p>做 PC 页面的时候，我们按照设计图的尺寸来就好。</p><p>做移动端页面的时候，设计师给了一份宽度为 640px 的设计图。那么，我们把这份设计图实现在各个手机上的过程就是『适配』。</p></div></section><section slide class=slide><div class=wrap wrap=true><p>以这个为例</p><p><img src=https://github-riskers-blog.oss-cn-qingdao.aliyuncs.com/20200327171753.jpg alt=app-demo></p></div></section><section slide class=slide><div class=wrap wrap=true><h2>适配方案一：固定高度，宽度自适应</h2><hr><pre class=language-html><code class=language-html><span class="token comment">&lt;!--这样设置之后，我们就可以不用管手机屏幕的尺寸进行开发了--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width=device-width,initial-scale=1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
</code></pre><ul><li :&amp;.movein=""><a href=http://www.meow.re/demo/screen-adaptation-in-mobileweb/app-fixed-height.html target=_blank>demo</a></li><li>配合媒体查询，解决大多数需求</li><li><a href=http://xw.qq.com/index.htm target=_blank>腾讯</a> <a href=http://m.jd.com/ target=_blank>京东</a> <a href=https://www.baidu.com/ target=_blank>百度</a> <a href=https://www.tmall.com/ target=_blank>天猫</a> <a href=http://www.amazon.cn/ target=_blank>亚马逊</a></li></ul></div></section><section slide class=slide><div class=wrap wrap=true><h2>适配方案二：固定宽度，viewport缩放</h2><hr><pre class=language-html><code class=language-html><span class="token comment">&lt;!--640 是根据设计图定下的，0.5 是根据屏幕宽度动态生成的--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>
    width=640,
    initial-scale=0.5,maximum-scale=0.5,minimum-scale=0.5,
    user-scalable=no<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
</code></pre><ul><li :&amp;.movein=""><a href=http://www.meow.re/demo/screen-adaptation-in-mobileweb/app-fixed-width.html target=_blank>demo</a></li><li><a href=http://m.lizhi.fm/ target=_blank>荔枝 FM</a> <a href=http://c.3g.163.com/CreditMarket/default.html target=_blank>网易新闻</a></li></ul></div></section><section slide class=slide><div class=wrap wrap=true><h2>适配方案二：固定宽度，viewport缩放</h2><hr><p><strong>设计图、页面宽度、viewport width 使用一个宽度，浏览器帮我们完成缩放。单位使用 px 即可</strong></p><p><img src=https://github-riskers-blog.oss-cn-qingdao.aliyuncs.com/20200327172013.gif alt=width-demo></p><p>[note] 生成的viewport告诉浏览器网页的布局视口使用 640px，然后把页面缩放成50%，这是绝对的等比例缩放。图片、文字等等所有元素都被缩放在手机屏幕中。 [/note]</p></div></section><section slide class=slide><div class=wrap wrap=true><h2>适配方案三：rem做宽度，viewport缩放</h2><hr><ul><li :&amp;.movein=""><a href=http://www.meow.re/demo/screen-adaptation-in-mobileweb/app-rem.html target=_blank>demo</a></li><li><a href=https://m.taobao.com target=_blank>淘宝</a> <a href=https://github.com/amfe/article/issues/17 target=_blank>使用 Flexible 实现手淘 H5 页面的终端适配</a></li></ul></div></section><section slide class=slide><div class=wrap wrap=true><h2>适配方案三：rem做宽度，viewport缩放</h2><hr><p><img src=https://github-riskers-blog.oss-cn-qingdao.aliyuncs.com/20200327171945.png alt=rem></p><p>动态生成：</p><ol><li>屏幕宽度设置 <code>rem</code>的大小，即给<code>&lt;html&gt;</code>设置<code>font-size</code></li><li>viewport init-scale</li><li>根据设备像素比（window.devicePixelRatio）给<code>&lt;html&gt;</code>设置<code>data-dpr</code></li></ol><p><strong>可以让不同设备的<code>rem</code>或<code>px</code>都显示一样的长度</strong></p></div></section><section slide class=slide><div class=wrap wrap=true><h2>适配方案三：rem做宽度，viewport缩放</h2><hr><h3>设置 rem</h3><p><strong>得到一个与屏幕宽度相关的单位</strong></p><p><img src=https://github-riskers-blog.oss-cn-qingdao.aliyuncs.com/20200327171834.png alt=rem></p><pre class=language-css><code class=language-css><span class="token selector">html</span><span class="token punctuation">{</span>
    <span class="token property">font-size</span><span class="token punctuation">:</span> 屏幕宽度 / 10<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.btn</span><span class="token punctuation">{</span>
    <span class="token property">width</span><span class="token punctuation">:</span>8.75rem<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span>1.25rem<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class=speaker-note><div class=wrap><p>这个长度是相对于设备本身的，不同设备的<code>rem</code>显示一样的长度（CSS像素）</p></div></div></section><section slide class=slide><div class=wrap wrap=true><h2>适配方案三：rem做宽度，viewport缩放</h2><h3>设置 viewport 缩放 和 data-dpr</h3><p><strong>适配高密度屏幕手机的<code>px</code>单位</strong></p><pre class=language-css><code class=language-css><span class="token selector">.a</span><span class="token punctuation">{</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span>12px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">[data-dpr="2"] .a</span><span class="token punctuation">{</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 24px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">[data-dpr="3"] .a</span><span class="token punctuation">{</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 36px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class=speaker-note><div class=wrap><p>设备像素比是2，缩放为0.5，<code>data-dpr</code>为 2</p><p>某元素字体大小应该为 12px，因为<code>[data-dpr=2]</code>，变成 24px，但又因为页面缩放 50%，所以还是 12px</p><p><strong>不同设备下的<code>px</code>显示一样的长度</strong></p></div></div></section><section slide class=slide :class=aligncenter><div class="wrap aligncenter" wrap=true><h1>8. 总结</h1></div></section><section slide class=slide><div class=wrap wrap=true><p><img src=https://github-riskers-blog.oss-cn-qingdao.aliyuncs.com/20200327171811.png alt=demo></p><p>第一种方案做简单页面还行，做复杂一点的就有点麻烦了。</p></div></section><section slide class=slide><div class=wrap wrap=true><p><img src=https://github-riskers-blog.oss-cn-qingdao.aliyuncs.com/20200327171431.png alt=PK活动></p><p>[note] 这是我曾经做过的一个页面，『PK』要和左右两张图平行，而且下面的『不怒自威』、『义薄云天』和下面的战斗力位置都要固定，不能有差。如果用第一种方案，可能各个元素就要绝对定位，然后各种百分比来定位了。且不说计算麻烦，而且辛苦一番最后的结果尺寸是和设计图有出入的。 [/note]</p></div></section><section slide class=slide><div class=wrap wrap=true><h2>第二种方案和第三种方案区别</h2><hr><p>目前我唯一知道的区别就是第三种方案更加灵活，有两种单位可以使用，想让元素适配的时候就用<code>rem</code>，想让文字不缩放的时候就用<code>px</code></p></div></section><section slide class=slide><div class=wrap wrap=true><h1>参考资料</h1><ul><li><p><a href=http://quirksmode.org/mobile/ target=_blank>ppk 的移动端系列文章</a></p></li><li><p><a href=http://www.quirksmode.org/blog/archives/2013/11/screenwidth_is.html target=_blank>screen.width is useless</a></p></li><li><p><a href=http://www.quirksmode.org/blog/archives/2012/06/devicepixelrati.html target=_blank>devicePixelRatio</a></p></li><li><p><a href=http://www.quirksmode.org/blog/archives/2012/07/more_about_devi.html target=_blank>More about devicePixelRatio</a></p></li><li><p><a href=http://div.io/topic/1092 target=_blank>移动端高清、多屏适配方案</a></p></li><li><p><a href=http://www.cnblogs.com/lyzg/p/4877277.html target=_blank>从网易与淘宝的 font-size 思考前端设计稿与工作流</a></p></li><li><p><a href=http://js8.in/2015/12/12/%E6%89%8B%E6%9C%BA%E7%99%BE%E5%BA%A6%E7%A7%BB%E5%8A%A8%E9%80%82%E9%85%8D%E5%88%87%E5%9B%BE%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E4%BB%8B%E7%BB%8D/ target=_blank>百度方案</a></p></li><li><p><a href=http://f2e.souche.com/blog/yi-dong-duan-zi-gua-ying-fang-an/ target=_blank>移动端自适应方案</a> 介绍了 flex 布局和 rem 方案</p></li></ul></div></section><section slide class=slide><div class=wrap wrap=true><h1>原文</h1><ul><li><a href=https://github.com/riskers/blog/issues/17 target=_blank>移动端适配方案(上)</a></li><li><a href=https://github.com/riskers/blog/issues/18 target=_blank>移动端适配方案(下)</a></li></ul></div></section><section slide class=slide><div class=wrap wrap=true><h1>END</h1></div></section><section slide class=slide><div class=wrap wrap=true><h1>切图神器</h1><hr><ul><li><a href=http://www.getmarkman.com/ target=_blank>MarkMan</a> / <a href=http://www.fancynode.com.cn/pxcook/home target=_blank>PxCook</a></li><li><a href=http://www.uisdc.com/tag/assistor-ps target=_blank>AssistorPS</a> / <a href=http://www.cutterman.cn/v2/parker target=_blank>parker</a></li><li><a href=http://www.cutterman.cn/v2/cutterman target=_blank>cutterman</a></li><li><a href=http://www.browsersync.cn/ target=_blank>browsersync</a></li></ul></div></section></article></div><script src="https://www.googletagmanager.com/gtag/js?id=UA-131910384-4"></script><script src=./gtag.js></script><script>window.pluginsOptions = {}



document.addEventListener('DOMContentLoaded', () => {
    let isPrintMode = false;
    if(~location.search.indexOf('print-pdf')){
        isPrintMode = true;
        WebSlides.registerPlugin('scroll', function(){});
    }
    const ws = new WebSlides({
        loop: false
    })
    window.wsInstance = ws;
    if(isPrintMode){
        ws.slides.forEach(s=>s.show())
    }
}, false)</script><script src=./md/img/js/chunk-vendors.js></script><script src=./md/img/js/flexible.js></script></body></html>